{"ast":null,"code":"import UserApi from \"@/api/UserApi\";\nexport default {\n  name: \"UserManage\",\n  data() {\n    return {\n      search: '',\n      type: '',\n      pageSize: 10,\n      pageNum: 1,\n      total: 0,\n      updateUserDrawer: false,\n      direction: 'rtl',\n      avatarPre: 'http://localhost:8001/userAvatar/',\n      userData: [],\n      userForm: {\n        userID: '',\n        userAccount: '',\n        userPassword: '',\n        userPhone: '',\n        userName: '',\n        userSex: '',\n        userAge: '',\n        userRole: '',\n        userDetail: '',\n        userAvatar: ''\n      }\n    };\n  },\n  methods: {\n    beforeAvatarUpload(file) {\n      const isLt20M = file.size / 1024 / 1024 / 1024 < 2;\n      if (file.type !== 'image/png' && file.type !== 'image/jpg' && file.type !== 'image/jpeg') {\n        this.$message.error('上传的头像只能是 PNG、JPG、JPEG格式!');\n        return false;\n      }\n      if (!isLt20M) {\n        this.$message.error('上传的头像大小不能超过 20MB!');\n        return false;\n      }\n      return true;\n    },\n    handleAvatarSuccess(res) {\n      this.$notify({\n        title: '上传头像',\n        message: '上传头像成功',\n        type: 'success',\n        offset: 100,\n        position: 'bottom-right'\n      });\n      this.userForm.userAvatar = res.data.userAvatar;\n    },\n    openUpdate(user) {\n      this.updateUserDrawer = true;\n      this.userForm.userID = user.userID;\n      this.userForm.userAccount = user.userAccount;\n      this.userForm.userPassword = user.userPassword;\n      this.userForm.userPhone = user.userPhone;\n      this.userForm.userName = user.userName;\n      this.userForm.userSex = user.userSex;\n      this.userForm.userAge = user.userAge;\n      this.userForm.userRole = user.userRole;\n      this.userForm.userDetail = user.userDetail;\n      this.userForm.userAvatar = user.userAvatar;\n    },\n    delUser(user) {\n      UserApi.delUser(user).then(res => res.data).then(res => {\n        this.searchUser();\n        if (res.code === 200) {\n          this.$notify({\n            title: '删除用户信息',\n            message: '删除用户信息成功',\n            type: 'success',\n            offset: 100\n          });\n        } else {\n          this.$notify({\n            title: '删除用户信息',\n            message: '删除用户信息失败',\n            type: 'error',\n            offset: 100\n          });\n        }\n      });\n    },\n    updateUser(user) {\n      UserApi.updateUser(user).then(res => res.data).then(res => {\n        this.searchUser();\n        this.updateUserDrawer = false;\n        if (res.code === 200) {\n          this.$notify({\n            title: '修改用户信息',\n            message: '修改用户信息成功',\n            type: 'success',\n            offset: 100\n          });\n        } else {\n          this.$notify({\n            title: '修改用户信息',\n            message: '修改用户信息失败',\n            type: 'error',\n            offset: 100\n          });\n        }\n      });\n    },\n    searchUser() {\n      console.log(this.type);\n      console.log(this.search);\n      UserApi.searchUser(this.pageSize, this.pageNum, this.type, this.search).then(res => res.data).then(res => {\n        this.userData = res.data;\n        this.total = res.total;\n        console.log(res.data);\n      });\n    },\n    handleSizeChange(val) {\n      this.pageSize = val;\n    },\n    handleCurrentChange(val) {\n      this.pageNum = val;\n    }\n  },\n  beforeMount() {\n    this.searchUser();\n  }\n};","map":{"version":3,"names":["UserApi","name","data","search","type","pageSize","pageNum","total","updateUserDrawer","direction","avatarPre","userData","userForm","userID","userAccount","userPassword","userPhone","userName","userSex","userAge","userRole","userDetail","userAvatar","methods","beforeAvatarUpload","file","isLt20M","size","$message","error","handleAvatarSuccess","res","$notify","title","message","offset","position","openUpdate","user","delUser","then","searchUser","code","updateUser","console","log","handleSizeChange","val","handleCurrentChange","beforeMount"],"sources":["src/components/UserManage/UserManage.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"dataForm\">\r\n      <el-input class=\"input\" v-model=\"search\" placeholder=\"请输入内容\" size=\"small\">\r\n        <el-select v-model=\"type\" clearable slot=\"prepend\" placeholder=\"请选择\">\r\n          <el-option label=\"用户昵称\" value=\"用户昵称\"></el-option>\r\n          <el-option label=\"用户账号\" value=\"用户账号\"></el-option>\r\n          <el-option label=\"用户权限\" value=\"用户权限\"></el-option>\r\n        </el-select>\r\n        <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"searchUser\"></el-button>\r\n      </el-input>\r\n      <el-button icon=\"el-icon-refresh\" style=\"float: left;margin-left: 10px\" size=\"small\" @click=\"reset\">重置</el-button>\r\n      <el-table\r\n          class=\"table\"\r\n          :data=\"userData\"\r\n          style=\"width: 100%;height: 400px\"\r\n          max-height=\"400px\">\r\n        <el-table-column\r\n            prop=\"userAccount\"\r\n            label=\"用户账号\"\r\n            width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"userName\"\r\n            label=\"用户昵称\"\r\n            width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"userPhone\"\r\n            label=\"用户电话\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"userRole\"\r\n            label=\"用户权限\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            label=\"操作\">\r\n          <template v-slot=\"scope\">\r\n            <el-tooltip content=\"修改用户\" placement=\"top\" effect=\"dark\">\r\n            <el-button icon=\"el-icon-edit\" plain size=\"mini\" @click=\"openUpdate(scope.row)\"></el-button>\r\n            </el-tooltip>\r\n            <el-tooltip content=\"删除用户信息\" placement=\"top\" effect=\"dark\">\r\n            <el-button type=\"danger\" icon=\"el-icon-delete\" plain size=\"mini\" @click=\"delUser(scope.row)\"></el-button>\r\n            </el-tooltip>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <el-drawer\r\n          title=\"修改用户信息\"\r\n          :visible.sync=\"updateUserDrawer\"\r\n          :direction=\"direction\">\r\n        <el-form ref=\"form\" :model=\"userForm\" label-width=\"80px\">\r\n          <el-upload\r\n              action=\"http://localhost:8001/userSys/uploadAvatar\"\r\n              :show-file-list=\"false\"\r\n              :on-success=\"handleAvatarSuccess\"\r\n              :before-upload=\"beforeAvatarUpload\">\r\n            <el-avatar :size=\"80\" :src=this.avatarPre+userForm.userAvatar></el-avatar>\r\n          </el-upload>\r\n\r\n          <el-form-item label=\"用户昵称\">\r\n          <el-input class=\"nameInput\" v-model=\"userForm.userName\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户电话\">\r\n            <el-input v-model=\"userForm.userPhone\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户账号\">\r\n            <el-input v-model=\"userForm.userAccount\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户密码\">\r\n            <el-input v-model=\"userForm.userPassword\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户年龄\">\r\n            <el-input v-model=\"userForm.userAge\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户性别\">\r\n            <el-radio class=\"radioOne\" v-model=\"userForm.userSex\" label=\"男\"><i class=\"el-icon-male\"></i>  男</el-radio>\r\n            <el-radio class=\"radioOne\" v-model=\"userForm.userSex\" label=\"女\"><i class=\"el-icon-female\"></i>  女</el-radio>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户权限\">\r\n            <el-radio class=\"radioTwo\" v-model=\"userForm.userRole\" label=\"管理员\" border size=\"medium\">管理员</el-radio>\r\n            <el-radio class=\"radioTwo\" v-model=\"userForm.userRole\" label=\"普通用户\" border size=\"medium\">普通用户</el-radio>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户简介\">\r\n            <el-input type=\"textarea\" v-model=\"userForm.userDetail\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item >\r\n            <el-button type=\"primary\" @click=\"updateUser(userForm)\" plain size=\"small\">立即修改</el-button>\r\n            <el-button size=\"small\">取消</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-drawer>\r\n\r\n      <el-pagination\r\n          class=\"page\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"pageNum\"\r\n          :page-sizes=\"[10, 15, 20]\"\r\n          :page-size=\"pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"total\"\r\n      >\r\n      </el-pagination>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport UserApi from \"@/api/UserApi\";\r\n\r\nexport default {\r\n  name: \"UserManage\",\r\n  data(){\r\n    return{\r\n      search:'',\r\n      type:'',\r\n      pageSize:10,\r\n      pageNum:1,\r\n      total:0,\r\n      updateUserDrawer:false,\r\n      direction:'rtl',\r\n      avatarPre:'http://localhost:8001/userAvatar/',\r\n      userData: [],\r\n      userForm: {\r\n        userID:'',\r\n        userAccount:'',\r\n        userPassword:'',\r\n        userPhone:'',\r\n        userName:'',\r\n        userSex:'',\r\n        userAge:'',\r\n        userRole:'',\r\n        userDetail:'',\r\n        userAvatar:''\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    beforeAvatarUpload(file) {\r\n      const isLt20M = file.size / 1024 / 1024 /1024 < 2;\r\n      if (file.type!=='image/png' && file.type!=='image/jpg' && file.type!=='image/jpeg') {\r\n        this.$message.error('上传的头像只能是 PNG、JPG、JPEG格式!');\r\n        return false\r\n      }\r\n      if (!isLt20M) {\r\n        this.$message.error('上传的头像大小不能超过 20MB!');\r\n        return false\r\n      }\r\n      return true;\r\n    },\r\n    handleAvatarSuccess(res){\r\n      this.$notify({\r\n        title: '上传头像',\r\n        message: '上传头像成功',\r\n        type:'success',\r\n        offset: 100,\r\n        position: 'bottom-right'\r\n      })\r\n      this.userForm.userAvatar=res.data.userAvatar\r\n    },\r\n    openUpdate(user){\r\n      this.updateUserDrawer=true\r\n      this.userForm.userID=user.userID\r\n      this.userForm.userAccount=user.userAccount\r\n      this.userForm.userPassword=user.userPassword\r\n      this.userForm.userPhone=user.userPhone\r\n      this.userForm.userName=user.userName\r\n      this.userForm.userSex=user.userSex\r\n      this.userForm.userAge=user.userAge\r\n      this.userForm.userRole=user.userRole\r\n      this.userForm.userDetail=user.userDetail\r\n      this.userForm.userAvatar=user.userAvatar\r\n    },\r\n    delUser(user){\r\n      UserApi.delUser(user).then(res=>res.data).then(res=>{\r\n        this.searchUser()\r\n        if (res.code===200){\r\n          this.$notify({\r\n            title: '删除用户信息',\r\n            message: '删除用户信息成功',\r\n            type:'success',\r\n            offset: 100\r\n          });\r\n        }else {\r\n          this.$notify({\r\n            title: '删除用户信息',\r\n            message: '删除用户信息失败',\r\n            type:'error',\r\n            offset: 100\r\n          });\r\n        }\r\n      })\r\n    },\r\n    updateUser(user){\r\n      UserApi.updateUser(user).then(res=>res.data).then(res=>{\r\n        this.searchUser()\r\n        this.updateUserDrawer=false\r\n        if (res.code===200){\r\n          this.$notify({\r\n            title: '修改用户信息',\r\n            message: '修改用户信息成功',\r\n            type:'success',\r\n            offset: 100\r\n          });\r\n        }else {\r\n          this.$notify({\r\n            title: '修改用户信息',\r\n            message: '修改用户信息失败',\r\n            type:'error',\r\n            offset: 100\r\n          });\r\n        }\r\n      })\r\n    },\r\n    searchUser(){\r\n      console.log(this.type)\r\n      console.log(this.search)\r\n      UserApi.searchUser(this.pageSize,this.pageNum,this.type,this.search).then(res=>res.data).then(res=>{\r\n        this.userData=res.data\r\n        this.total=res.total\r\n        console.log(res.data)\r\n      })\r\n    },\r\n    handleSizeChange(val) {\r\n      this.pageSize=val\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.pageNum=val\r\n    },\r\n  },\r\n  beforeMount() {\r\n    this.searchUser()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.dataForm{\r\n  width: 800px;\r\n  height: 500px;\r\n  margin-top: 10px;\r\n  margin-left: 10px;\r\n  float: left;\r\n  padding: 10px;\r\n  background: rgba( 254, 252, 252, 0.8 );\r\n  border-radius: 15px;\r\n  border: 1px solid rgba( 255, 255, 255, 0.18 );\r\n}\r\n.el-select{\r\n  width: 100px;\r\n}\r\n\r\n.radioOne{\r\n  float: left;\r\n  margin-right: 30px;\r\n  margin-left: 10px;\r\n  margin-top: 10px;\r\n}\r\n.radioTwo{\r\n  float: left;\r\n  margin-right: 3px;\r\n}\r\n.el-input{\r\n  width: 350px;\r\n  float: left;\r\n  opacity: 0.8;\r\n}\r\n.btn{\r\n  float: left;\r\n  margin-left: 20px;\r\n}\r\n.btn:hover{\r\n  background-color: rgba( 255, 255, 255, 0.3 );\r\n  transform: scale(1.1);\r\n  transition: all 0.6s;\r\n}\r\n.table{\r\n  margin-top: 20px;\r\n  float: left;\r\n}\r\n.page{\r\n  float: left;\r\n  background-color: rgba( 254, 252, 252, 0.8 );\r\n  opacity: 0.8;\r\n  margin-left: 150px;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}